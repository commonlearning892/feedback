<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sri Chaitanya Techno Schools – Tamil Nadu | Academic Year 2025–26</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="alternate icon" href="favicon.svg">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html { font-size: clamp(14px, 0.95vw + 8px, 18px); }
        body { 
            font-family: 'Inter', -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', 'Liberation Sans', sans-serif; 
            background: linear-gradient(135deg, #001f3f 0%, #003d7a 50%, #005bb5 100%);
            padding: 20px; 
            color: #333;
            min-height: 100vh;
            line-height: 1.45;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            text-rendering: optimizeLegibility;
            overflow-x: hidden;
        }
        .container { max-width: 1400px; width: 100%; margin: 0 auto; }
        header { 
            background: linear-gradient(135deg, #ffffff 0%, #f0f8ff 100%);
            padding: 40px; 
            border-radius: 20px; 
            box-shadow: 0 15px 40px rgba(0,0,0,0.3); 
            margin-bottom: 30px; 
            text-align: center;
            border: 3px solid #ffd700;
        }
        h1 { 
            color: #001f3f; 
            font-size: clamp(1.3rem, 3.2vw, 3rem); 
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
            white-space: nowrap;
        }
        .subtitle { color: #003d7a; font-size: clamp(0.95rem, 1.2vw, 1.15rem); font-weight: 500; }
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .stat-card { 
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
            padding: 25px; 
            border-radius: 15px; 
            box-shadow: 0 8px 20px rgba(0,0,0,0.2); 
            transition: all 0.3s;
            color: white;
            border: 2px solid rgba(255,255,255,0.3);
        }
        .stat-card:nth-child(2) { background: linear-gradient(135deg, #4ecdc4 0%, #44a08d 100%); }
        .stat-card:nth-child(3) { background: linear-gradient(135deg, #f7b731 0%, #f39c12 100%); }
        .stat-card:nth-child(4) { background: linear-gradient(135deg, #5f27cd 0%, #341f97 100%); }
        .stat-card:hover { transform: translateY(-8px) scale(1.02); box-shadow: 0 12px 30px rgba(0,0,0,0.3); }
        .stat-card h3 { color: white; font-size: 1.2em; margin-bottom: 10px; font-weight: 600; }
        .stat-value { font-size: 2.8em; font-weight: bold; color: white; text-shadow: 2px 2px 4px rgba(0,0,0,0.2); }
        .chart-container { 
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
            padding: 35px; 
            border-radius: 15px; 
            box-shadow: 0 10px 25px rgba(0,0,0,0.2); 
            margin-bottom: 30px;
            border: 2px solid rgba(255,215,0,0.3);
        }
        .chart-container h2 { 
            color: #001f3f; 
            margin-bottom: 20px; 
            font-size: clamp(1.05rem, 1.6vw, 1.5rem); 
            border-bottom: 4px solid #ffd700; 
            padding-bottom: 12px;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }
        .chart-wrapper { position: relative; height: 400px; margin-bottom: 20px; }
        .ranking-table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        .ranking-table th { 
            background: linear-gradient(135deg, #001f3f 0%, #003d7a 100%);
            color: white; 
            padding: 18px; 
            text-align: left; 
            font-weight: 600;
            font-size: 1.05em;
        }
        .ranking-table td { padding: 14px 15px; border-bottom: 2px solid #e3e8ef; }
        .ranking-table tr:hover { background: linear-gradient(135deg, #fff9e6 0%, #ffe6cc 100%); }

        /* Compact tables under charts (Avg + bucket counts) */
        #summaryCategoryTable, #communicationTable, #adminTable, #infraCategoryTable, #programExcellenceTable {
            margin-top: 14px;
            font-size: 0.9em;
        }
        #summaryCategoryTable th, #communicationTable th, #adminTable th, #infraCategoryTable th, #programExcellenceTable th {
            font-size: 0.95em;
            font-weight: 700;
        }
        #summaryCategoryTable th, #summaryCategoryTable td,
        #communicationTable th, #communicationTable td,
        #adminTable th, #adminTable td,
        #infraCategoryTable th, #infraCategoryTable td,
        #programExcellenceTable th, #programExcellenceTable td {
            padding: 10px 12px;
        }

        /* Single-line compact rendering for Overall Satisfaction by Category table */
        #summaryCategoryTableWrap {
            overflow-x: auto;
            border: 2px solid rgba(0, 31, 63, 0.12);
            border-radius: 12px;
            background: #ffffff;
        }
        #summaryCategoryTable {
            white-space: nowrap;
            width: max-content;
            min-width: 100%;
            margin-top: 0;
            font-size: 0.98em;
        }
        #summaryCategoryTable thead th {
            position: sticky;
            top: 0;
            z-index: 2;
        }
        #summaryCategoryTable th, #summaryCategoryTable td { white-space: nowrap; padding: 10px 12px; }
        #summaryCategoryTable tbody tr:nth-child(even) { background: rgba(0, 61, 122, 0.04); }
        .score-badge { display: inline-block; padding: 6px 18px; border-radius: 25px; font-weight: bold; color: white; box-shadow: 0 2px 8px rgba(0,0,0,0.2); }
        .score-excellent { background: linear-gradient(135deg, #4caf50 0%, #45a049 100%); }
        .score-good { background: linear-gradient(135deg, #2196f3 0%, #1976d2 100%); }
        .score-average { background: linear-gradient(135deg, #ff9800 0%, #f57c00 100%); }
        .grid-2 { display: grid; grid-template-columns: repeat(auto-fit, minmax(500px, 1fr)); gap: 30px; margin-bottom: 30px; }
        @media (max-width: 768px) { .grid-2 { grid-template-columns: 1fr; } .chart-wrapper { height: 300px; } }
        @media (max-width: 640px) {
            body { padding: 12px; }
            header { padding: 18px; border-radius: 16px; }
            h1 { white-space: normal; }
            .brand { flex-wrap: wrap; gap: 10px; }
            .brand .logo { height: clamp(54px, 16vw, 90px); }
            .chart-container { padding: 18px; }
            .grid-2 { gap: 16px; }
            .chart-row { flex-direction: column; }
            .side-kpi { min-width: auto; width: 100%; }
            .controls-bar { flex-direction: column; align-items: stretch; }
            .controls-bar select, .controls-bar button { width: 100%; }
            #segmentChecks { width: 100%; flex-wrap: wrap; }
            .stats-grid { grid-template-columns: 1fr; }
            .kpi-grid { grid-template-columns: 1fr; }
        }
        @media (max-width: 480px) {
            body { padding: 10px; }
            header { padding: 14px; }
            .chart-container { padding: 14px; }
            .chart-wrapper { height: 260px; }
            .chart-row .chart-wrapper { height: 240px; }
            .kpi { padding: 14px; }
            .ranking-table th, .ranking-table td { padding: 12px; }
        }
        .tabs { display: none; }
        .tab-btn { background: linear-gradient(135deg, #ffd700 0%, #ff9d00 100%); color: #001f3f; border: none; padding: 10px 16px; border-radius: 30px; font-weight: 700; cursor: pointer; box-shadow: 0 6px 18px rgba(0,0,0,0.2); transition: transform 0.2s ease; font-size: clamp(0.9rem, 1.1vw, 1rem); }
        .tab-btn:hover { transform: translateY(-2px); }
        .tab-btn.active { outline: 3px solid rgba(255,255,255,0.8); }
        .section { display: block; }
        /* Accordion styles */
        .section-toggle { display: flex; align-items: center; justify-content: space-between; background: linear-gradient(135deg, #ffd700 0%, #ff9d00 100%); color: #001f3f; border-radius: 12px; padding: 10px 14px; font-weight: 800; margin: 16px 0 8px; cursor: pointer; box-shadow: 0 6px 18px rgba(0,0,0,0.15); font-size: clamp(0.95rem, 1.2vw, 1.05rem); }
        .section.collapsed .section-content { display: none; }
        .controls-bar { display: flex; gap: 12px; align-items: center; margin: 10px 0 20px; flex-wrap: wrap; background: linear-gradient(135deg, rgba(255,255,255,0.96) 0%, rgba(240,248,255,0.96) 100%); border: 2px solid rgba(255,215,0,0.35); border-radius: 14px; padding: 12px 14px; box-shadow: 0 10px 25px rgba(0,0,0,0.18); }
        .controls-bar .label { color: #001f3f !important; font-weight: 800; }
        .controls-bar select, .controls-bar button { padding: 10px 12px; border-radius: 10px; border: 2px solid rgba(255,215,0,0.5); background: #ffffff; font-weight: 700; color: #001f3f; font-size: clamp(0.9rem, 1.1vw, 1rem); }
        .filters { display: flex; gap: 12px; flex-wrap: wrap; margin-bottom: 15px; }
        .filters select { padding: 10px 12px; border-radius: 10px; border: 2px solid rgba(255,215,0,0.5); background: #ffffff; font-weight: 600; font-size: clamp(0.9rem, 1.1vw, 1rem); }
        .kpi-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); gap: 16px; margin-bottom: 20px; }
        .kpi { background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%); border: 2px solid rgba(255,215,0,0.3); border-radius: 14px; padding: 16px; box-shadow: 0 8px 20px rgba(0,0,0,0.15); }
        .kpi .label { color: #003d7a; font-weight: 700; margin-bottom: 6px; }
        .kpi .value { font-size: clamp(1rem, 1.8vw, 1.8rem); color: #001f3f; font-weight: 800; white-space: nowrap; line-height: 1.15; }
        .chart-row { display: flex; gap: 24px; align-items: stretch; }
        .chart-row .chart-wrapper { flex: 1; }
        .side-kpi { min-width: 260px; display: flex; flex-direction: column; gap: 12px; }
        .side-kpi .kpi .value { font-size: clamp(0.95rem, 1.4vw, 1.3rem); white-space: nowrap; }
        .brand { display: flex; align-items: center; justify-content: center; gap: clamp(12px, 1.2vw, 22px); flex-wrap: nowrap; margin: 0 auto; }
        .brand .logo { height: clamp(56px, 7.5vw, 110px); width: auto; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.15); }
        .brand .titles { text-align: center; }
        .reason-list { list-style: none; padding-left: 0; margin: 0; }
        .reason-list li { display: flex; justify-content: space-between; gap: 12px; padding: 3px 0; font-weight: 600; }
        .reason-title { font-weight: 800; margin-bottom: 8px; }
        .reason-title.yes { color: #43a047; }
        .reason-title.maybe { color: #fb8c00; }
        .reason-title.no { color: #e53935; }
        /* Ensure Segment Overall KPI numbers and % fit on one line */
        #segmentCountsGrid .kpi .value { font-size: clamp(0.95rem, 1.4vw, 1.4rem); white-space: nowrap; }
        /* Ensure Executive Summary KPI values fit on one line */
        #execKpiGrid .kpi .value { font-size: clamp(0.95rem, 1.6vw, 1.6rem); white-space: nowrap; }
        /* Table typography */
        .ranking-table th { font-size: clamp(0.9rem, 1.1vw, 1.05rem); }
        .ranking-table td { font-size: clamp(0.85rem, 1vw, 0.95rem); }
        canvas { max-width: 100% !important; }
        img { max-width: 100%; height: auto; }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="brand">
                <img src="logo.png" alt="School Logo" class="logo" onerror="this.style.display='none'" />
                <div class="titles">
                    <h1>Sri Chaitanya Techno Schools – Tamil Nadu</h1>
                    <p class="subtitle">Academic & Administrative Review • Academic Year: 2025–26</p>
                </div>
            </div>
        </header>
        
        <div class="controls-bar">
            <label for="globalBranchSelect" class="label" style="color:#003d7a; font-weight:800;">Branch:</label>
            <select id="globalBranchSelect"><option value="">All Branches</option></select>
            <label for="compareBySelect" class="label" style="color:#003d7a; font-weight:800;">Compare By:</label>
            <select id="compareBySelect">
                <option value="none">None</option>
                <option value="segment">Segment</option>
                <option value="class">Class</option>
                <option value="orientation">Orientation</option>
            </select>
            <span id="segmentChecks" style="display:none; gap:10px;"></span>
            <button id="expandAllBtn">Expand All</button>
            <button id="collapseAllBtn">Collapse All</button>
        </div>

        <div id="content">
            <nav class="tabs">
                <button class="tab-btn active" data-tab="exec">Executive Summary</button>
                <button class="tab-btn" data-tab="academic">Academic Quality</button>
                <button class="tab-btn" data-tab="env">Environment & Safety</button>
                <button class="tab-btn" data-tab="comm">Communication & Administration</button>
                <button class="tab-btn" data-tab="infra">Infrastructure & Facilities</button>
                <button class="tab-btn" data-tab="strengths">Strengths & Improvements</button>
            </nav>

            <section id="section-exec" class="section active">
                <div class="kpi-grid" id="execKpiGrid"></div>
                <div class="chart-container">
                    <h2>Segment Responses (All / Selected Branch)</h2>
                    <div class="kpi-grid" id="segmentTotalsGrid"></div>
                </div>
                <div class="chart-container">
                    <h2>Segment Overall (All / Selected Branch)</h2>
                    <div class="kpi-grid" id="segmentCountsGrid"></div>
                    <div class="chart-wrapper" style="height: 180px;"><canvas id="segmentYNMChart"></canvas></div>
                    <div class="chart-wrapper"><canvas id="segmentOverallChart"></canvas></div>
                </div>
                <div class="grid-2">
                    <div class="chart-container">
                        <h2>Overall Satisfaction by Category</h2>
                        <div class="chart-wrapper"><canvas id="summaryCategoryChart"></canvas></div>
                        <div id="summaryCategoryTableWrap">
                            <table class="ranking-table" id="summaryCategoryTable"></table>
                        </div>
                    </div>
                    <div class="chart-container">
                        <h2>Recommendation Status</h2>
                        <div class="chart-row">
                            <div class="chart-wrapper"><canvas id="recommendationChart"></canvas></div>
                            <div class="side-kpi">
                                <div class="kpi">
                                    <div class="label">% Recommend School</div>
                                    <div class="value" id="recYesPctKpi">-</div>
                                </div>
                                <div class="kpi-grid" id="recCountsGrid">
                                    <div class="kpi"><div class="label">Yes</div><div class="value" id="recYesCount">-</div></div>
                                    <div class="kpi"><div class="label">No</div><div class="value" id="recNoCount">-</div></div>
                                    <div class="kpi"><div class="label">Maybe</div><div class="value" id="recMaybeCount">-</div></div>
                                </div>
                            </div>
                        </div>
                        <div class="kpi-grid" id="recReasonsGrid">
                            <div class="kpi">
                                <div class="reason-title yes">Why Yes (Top %)</div>
                                <ul class="reason-list" id="recYesList"></ul>
                            </div>
                            <div class="kpi">
                                <div class="reason-title no">Why No (Top %)</div>
                                <ul class="reason-list" id="recNoList"></ul>
                            </div>
                        </div>
                    </div>
                </div>
                
            </section>

            <section id="section-academic" class="section">
                <div class="chart-container">
                    <h2>Overall Subject-wise Performance</h2>
                    <div class="chart-wrapper"><canvas id="subjectStackedChart"></canvas></div>
                </div>
                <div class="chart-container">
                    <h2>Overall Subject Distribution (Counts and %)</h2>
                    <table class="ranking-table" id="subjectCountsTable"></table>
                </div>
                <div class="chart-container">
                    <h2>Program for Excellence</h2>
                    <div class="chart-wrapper"><canvas id="programExcellenceChart"></canvas></div>
                    <table class="ranking-table" id="programExcellenceTable"></table>
                </div>
            </section>

            <section id="section-env" class="section">
                <div class="chart-container">
                    <h2>Overall Environment &amp; Safety Performance</h2>
                    <div class="chart-wrapper"><canvas id="envRatingsChart"></canvas></div>
                </div>
                <div class="kpi-grid">
                    <div class="kpi"><div class="label">Safety Score</div><div class="value" id="safetyKpi">-</div></div>
                    <div class="kpi"><div class="label">Hygiene Score</div><div class="value" id="hygieneKpi">-</div></div>
                </div>
                <div class="chart-container">
                    <h2>Overall Environment Distribution (Counts and %)</h2>
                    <table class="ranking-table" id="envCountsTable"></table>
                </div>
            </section>

            <section id="section-comm" class="section">
                <div class="chart-container">
                    <h2>Communication Effectiveness</h2>
                    <div class="chart-wrapper"><canvas id="communicationChart"></canvas></div>
                    <table class="ranking-table" id="communicationTable"></table>
                </div>
                <div class="chart-container">
                    <h2>Administrative Support Ratings</h2>
                    <div class="chart-wrapper"><canvas id="adminChart"></canvas></div>
                    <table class="ranking-table" id="adminTable"></table>
                </div>
                <div class="chart-container">
                    <h2>Concern Resolution Satisfaction</h2>
                    <div class="chart-wrapper"><canvas id="concernResolutionChart"></canvas></div>
                    <div class="kpi-grid" id="concernCountsGrid">
                        <div class="kpi"><div class="label">Yes</div><div class="value" id="concernYesCount">-</div></div>
                        <div class="kpi"><div class="label">No</div><div class="value" id="concernNoCount">-</div></div>
                        <div class="kpi"><div class="label">Not Applicable</div><div class="value" id="concernNaCount">-</div></div>
                    </div>
                </div>
            </section>

            <section id="section-infra" class="section">
                <div class="chart-container">
                    <h2>Infrastructure Category Ratings</h2>
                    <div class="chart-wrapper"><canvas id="infraCategoryChart"></canvas></div>
                    <table class="ranking-table" id="infraCategoryTable"></table>
                </div>
                <div class="chart-container">
                    <h2>Needs Improvement Heatmap</h2>
                    <div style="margin-bottom: 16px;">
                        <label for="heatmapCategoryFilter" style="font-weight: 700; margin-right: 8px; color: #001f3f;">Sort by Category:</label>
                        <select id="heatmapCategoryFilter" style="padding: 6px 12px; font-size: 14px; border: 2px solid #001f3f; border-radius: 4px; background: white; cursor: pointer; font-weight: 600;">
                            <option value="Overall">Overall Performance</option>
                            <option value="Academics">Academics</option>
                            <option value="Infrastructure">Infrastructure</option>
                            <option value="Environment">Environment</option>
                            <option value="Administration">Administration</option>
                        </select>
                    </div>
                    <div id="infraHeatmap"></div>
                </div>
            </section>

            <section id="section-strengths" class="section">
                <div class="grid-2">
                    <div class="chart-container">
                        <h2>Top Strength Areas</h2>
                        <div class="chart-wrapper"><canvas id="topStrengthsChart"></canvas></div>
                    </div>
                    <div class="chart-container">
                        <h2>Top Improvement Areas</h2>
                        <div class="chart-wrapper"><canvas id="topImprovementsChart"></canvas></div>
                    </div>
                </div>
            </section>

            <section id="section-branch" class="section">
                <div class="chart-container">
                    <h2>Branch-wise Overall Score</h2>
                    <div class="chart-wrapper"><canvas id="branchRankedChart"></canvas></div>
                </div>
                <div class="grid-2">
                    <div class="chart-container">
                        <h2>Branch-wise Recommendation %</h2>
                        <div class="chart-wrapper"><canvas id="branchRecommendChart"></canvas></div>
                    </div>
                    <div class="chart-container">
                        <h2>Top 5 Branches by Reviews (All)</h2>
                        <table class="ranking-table" id="branchTopReviewsTable"></table>
                    </div>
                </div>
                <div class="grid-2">
                    <div class="chart-container" style="grid-column: 1 / -1;">
                        <div class="filters">
                            <label for="branchClassFilter" class="label" style="align-self:center;color:#003d7a;font-weight:700;">Class:</label>
                            <select id="branchClassFilter"><option value="">All Classes</option></select>
                            <label for="branchOrientationFilter" class="label" style="align-self:center;color:#003d7a;font-weight:700;">Orientation:</label>
                            <select id="branchOrientationFilter"><option value="">All Orientations</option></select>
                        </div>
                    </div>
                    <div class="chart-container">
                        <h2>Top Branches: Yes Recommendations (Count)</h2>
                        <table class="ranking-table" id="branchYesRecsTable"></table>
                    </div>
                    <div class="chart-container">
                        <h2>Top Branches: No Recommendations (Count)</h2>
                        <table class="ranking-table" id="branchNoRecsTable"></table>
                    </div>
                </div>
                <div class="chart-container">
                    <div class="filters">
                        <label for="ratingGroupSelect" class="label" style="align-self:center;color:#003d7a;font-weight:700;">Rating Group:</label>
                        <select id="ratingGroupSelect">
                            <option>Subjects</option>
                            <option>Environment</option>
                            <option>Infrastructure</option>
                            <option>Parent-Teacher</option>
                            <option>Administrative Support</option>
                        </select>
                    </div>
                    <div class="grid-2">
                        <div class="chart-container">
                            <h2>Top Branches: Excellent Ratings (Count)</h2>
                            <table class="ranking-table" id="branchExcellentTable"></table>
                        </div>
                        <div class="chart-container">
                            <h2>Top Branches: Poor Ratings (Count)</h2>
                            <table class="ranking-table" id="branchPoorTable"></table>
                        </div>
                    </div>
                </div>
            </section>
            
        </div>
    </div>
    
    <script src="dashboard.js"></script>
</body>
</html>
